const debug=require("debug")("feathers:application"),stripSlashes=require("@feathersjs/commons")["stripSlashes"],Uberproto=require("uberproto"),events=require("./events"),hooks=require("./hooks"),version=require("./version"),Proto=Uberproto.extend({create:null}),application={init(){Object.assign(this,{version:version,methods:["find","get","create","update","patch","remove"],mixins:[],services:{},providers:[],_setup:!1,settings:{}}),this.configure(hooks()),this.configure(events())},get(e){return this.settings[e]},set(e,s){return this.settings[e]=s,this},disable(e){return this.settings[e]=!1,this},disabled(e){return!this.settings[e]},enable(e){return this.settings[e]=!0,this},enabled(e){return!!this.settings[e]},configure(e){return e.call(this,this),this},service(e,s){if(void 0!==s)throw new Error("Registering a new service with `app.service(path, service)` is no longer supported. Use `app.use(path, service)` instead.");s=stripSlashes(e)||"/",e=this.services[s];return void 0===e&&"function"==typeof this.defaultService?this.use(s,this.defaultService(s)).service(s):e},use(e,s,t={}){if("string"!=typeof e)throw new Error(`'${e}' is not a valid service path.`);const i=stripSlashes(e)||"/";var e="function"==typeof s.service&&s.services,r=this.methods.concat("setup").some(e=>"function"==typeof s[e]);if(e){const n=s;return Object.keys(n.services).forEach(e=>this.use(i+"/"+e,n.service(e))),this}if(!r)throw new Error(`Invalid service object passed for path \`${i}\``);const o=Proto.isPrototypeOf(s)?s:Proto.extend(s);return debug(`Registering new service at \`${i}\``),this.mixins.forEach(e=>e.call(this,o,i,t)),"function"==typeof o._setup&&o._setup(this,i),this.providers.forEach(e=>e.call(this,o,i,t)),this._isSetup&&"function"==typeof o.setup&&(debug(`Setting up service for \`${i}\``),o.setup(this,i)),this.services[i]=o,this},setup(){return Object.keys(this.services).forEach(e=>{const s=this.services[e];debug(`Setting up service for \`${e}\``),"function"==typeof s.setup&&s.setup(this,e)}),this._isSetup=!0,this}};module.exports=application;